@page "/refresh"

@using System.Security.Claims
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Components.Authorization
@using IApply.Frontend.Common.Constants
@using IApply.Frontend.Models
@using IApply.Frontend.Models.Auth.Login
@using IApply.Frontend.Services
@using IApply.Frontend.Services.ApiService.Auth
@layout AuthLayout

@inject IAuthService _accountService
@inject NavigationManager _navigationManager
@inject LoadingService LoadingService


@code {
    protected override async Task OnInitializedAsync()
    {
        await RemoveAuthStateAsync();
    }

    private async Task RemoveAuthStateAsync()
    {
        var req = new RefreshTokenRequest();
        await _accountService.RefreshToken(req);
        // LoadingService.Show();
        // await httpContextAccessor.HttpContext.SignOutAsync(Constants.AUTH_SCHEME);       
        // await InvokeAsync(StateHasChanged);

        // _navigationManager.NavigateTo("./");
    }
}
